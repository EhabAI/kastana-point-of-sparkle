{
  "meta": {
    "project": "Kastana POS",
    "language": "ar",
    "style": "clear_formal_arabic_with_system_terms",
    "source_of_truth": "github_repo",
    "last_updated": "2026-01-18"
  },

  "core_concepts": {
    "order_states": {
      "OPEN": "طلب مفتوح قابل للإضافة والتعديل والدفع",
      "ON_HOLD": "طلب معلّق لا يسمح بالدفع أو التعديل",
      "CLOSED": "طلب مغلق بعد إتمام الدفع"
    },
    "payment_methods": ["Cash", "Card"],
    "roles": ["Cashier", "Owner", "SystemAdmin"]
  },

  "features": [
    {
      "key": "new_order",
      "title": "إنشاء طلب جديد",
      "roles": ["Cashier"],
      "screens": ["POS"],
      "description": "إنشاء طلب Takeaway أو Dine-in وبدء إضافته.",
      "flow": ["اختيار نوع الطلب", "إضافة الأصناف", "حفظ الطلب بحالة OPEN"],
      "notes": ["الطلب يبقى OPEN حتى الدفع", "لا يدخل أي تقرير قبل الدفع"]
    },
    {
      "key": "hold_resume_order",
      "title": "تعليق واستئناف الطلب",
      "roles": ["Cashier"],
      "screens": ["POS"],
      "description": "إيقاف الطلب مؤقتًا ومنع الدفع عليه.",
      "states": {
        "from": "OPEN",
        "to": "ON_HOLD"
      },
      "notes": ["لا يمكن الدفع على الطلب المعلّق", "لا يظهر في التقارير"]
    },
    {
      "key": "tables_management",
      "title": "إدارة الطاولات",
      "roles": ["Cashier"],
      "screens": ["Tables"],
      "description": "إدارة الطلبات داخل الصالة حسب الطاولات.",
      "rules": ["الطاولة OCCUPIED عند وجود طلب OPEN", "الطاولة FREE عند إغلاق الطلب"]
    },
    {
      "key": "merge_orders",
      "title": "دمج طلبات الطاولات",
      "roles": ["Cashier"],
      "screens": ["Tables"],
      "description": "دمج أكثر من طلب مفتوح لطاولات مختلفة.",
      "rules": ["يتم الدمج على الطلب الأقدم", "جميع العناصر تنتقل للطلب الأقدم"]
    },
    {
      "key": "move_order_between_tables",
      "title": "نقل الطلب بين الطاولات",
      "roles": ["Cashier"],
      "screens": ["Tables"],
      "description": "نقل طلب مفتوح من طاولة إلى أخرى."
    },
    {
      "key": "payment",
      "title": "الدفع",
      "roles": ["Cashier"],
      "screens": ["POS"],
      "description": "إتمام الدفع النقدي أو البطاقة.",
      "effects": ["إغلاق الطلب", "تحديث التقارير", "خصم المخزون"]
    },
    {
      "key": "refund",
      "title": "المرتجعات",
      "roles": ["Cashier", "Owner"],
      "screens": ["POS"],
      "description": "إرجاع طلب مدفوع.",
      "rules": ["يؤثر على التقارير", "يُسجّل في Audit Logs"]
    },
    {
      "key": "void_order",
      "title": "إلغاء الطلب",
      "roles": ["Cashier"],
      "screens": ["POS"],
      "description": "إلغاء الطلب قبل الدفع فقط."
    },
    {
      "key": "inventory_recipes",
      "title": "المخزون والوصفات",
      "roles": ["Owner"],
      "screens": ["Inventory"],
      "description": "ربط الأصناف بوصفات لخصم المخزون تلقائيًا.",
      "rules": ["الخصم يتم عند الدفع فقط", "الأصناف بدون وصفة لا تُخصم"]
    },
    {
      "key": "reports_overview",
      "title": "التقارير",
      "roles": ["Owner"],
      "screens": ["Dashboard"],
      "description": "عرض تقارير Z، النقد، والمخزون."
    }
  ],

  "audit_logs": [
    "ORDER_CREATED",
    "ORDER_ON_HOLD",
    "ORDER_RESUMED",
    "ORDER_MERGED",
    "ORDER_MOVED_TABLE",
    "PAYMENT_COMPLETED",
    "REFUND_CREATED",
    "VOID_CREATED",
    "INVENTORY_DEDUCTED",
    "SHIFT_OPENED",
    "SHIFT_CLOSED"
  ]
}
